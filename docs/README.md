# YT-Assistant

YT-Assistant is a web application designed to help users summarize YouTube video transcripts and extract valuable insights through question answering and reasoning. The app leverages LLMs for NLP tasks, including text summarization and Q&A. It stores video metadata and user data in a PostgreSQL database with the pgvector extension, enabling efficient retrieval for Retrieval-Augmented Generation tasks.

## Features

- User Authentification
- YouTube video transcripts summarization
- Q&A sessions
- Storing video summaries for RAG

## Stack

- **Backend**: FastAPI + Auth0
- **Frontend**: React + TypeScript + Tailwind CSS
- **Database**: PostgreSQL + pgvector
- **AI Integration**: Hugging Face API (for prototyping; can be changed to OpenAI)

# Local Environment

## Dependencies

- Python 3.12
- Poetry 2.1.2
- Node.js v22 + npm v10
- Docker

## Setup

Run the following to install dependencies, build containers and start the project:

```bash
./scripts/init.sh
```

With `--no-build` flag the script will just run the project from local environment

## Environment

Environment variables are stored in `*.env` files in `env/` directory, e.g. `./env/api.env`, `./env/.api.env` etc.

**`.api.env`**

```
ENV=
API_HOST=
API_PORT=
CLIENT_HOST=
CLIENT_PORT=
HUGGINGFACE_API_KEY=
POSTGRES_URL=postgresql://<user>:<password>@<host>:<port>/<db_name>
AUTH0_DOMAIN=
AUTH0_AUDIENCE=
CORS_ORIGINS=http://localhost:3000,http://prod-frontend.com
```

**`.db.env`**

```
ENV=
POSTGRES_USER=
POSTGRES_PASSWORD=
POSTGRES_DB=
```

**`.client.env`**

```
VITE_ENV=
VITE_API_HOST=
VITE_API_PORT=
VITE_CLIENT_HOST=
VITE_CLIENT_PORT=
VITE_AUTH0_DOMAIN=
VITE_AUTH0_AUDIENCE=
VITE_AUTH0_CLIENT_ID=
```

# API Documentation

To access API documentation (Swagger UI), navigate to [localhost:8000/docs](localhost:8000/docs)

## Endpoints

- `GET /accounts/me` â€“ Get the authenticated user's account (Auth0 protected)

# DB Schema

![db_schema_diagram](db_schema.png)

## account

Stores user id from Auth0.

| Column Name | Type    | Description             |
| ----------- | ------- | ----------------------- |
| id          | VARCHAR | Auth0 ID (sub from JWT) |

## video

Stores metadata about videos and their transcripts.

| Column Name | Type      | Description               |
| ----------- | --------- | ------------------------- |
| id          | UUID      | Primary key               |
| created_at  | TIMESTAMP | Timestamp of video upload |
| title       | VARCHAR   | Video title               |
| url         | VARCHAR   | YouTube video URL         |

## account_video

Tracks the videos that a account has interacted with.

| Column Name | Type      | Description                             |
| ----------- | --------- | --------------------------------------- |
| id          | UUID      | Primary key                             |
| created_at  | TIMESTAMP | Timestamp of account's last interaction |
| account_id  | UUID      | Foreign key to `account` (created by)   |
| video_id    | UUID      | Foreign key to `video`                  |

## transcript

Stores the raw transcript text or file paths.

| Column Name     | Type      | Description                      |
| --------------- | --------- | -------------------------------- |
| id              | UUID      | Primary key                      |
| created_at      | TIMESTAMP | Timestamp of transcript creation |
| video_id        | UUID      | Foreign key to Video table       |
| transcript_text | TEXT      | Raw transcript content           |

## summaries

Stores the video summary generated by the Hugging Face API.

| Column Name  | Type      | Description                     |
| ------------ | --------- | ------------------------------- |
| id           | UUID      | Primary key                     |
| created_at   | TIMESTAMP | Timestamp of summary generation |
| video_id     | UUID      | Foreign key to `videos`         |
| summary_text | TEXT      | Summary content                 |

## qa

Stores account questions and generated answers.

| Column Name   | Type      | Description                           |
| ------------- | --------- | ------------------------------------- |
| id            | UUID      | Primary key                           |
| created_at    | TIMESTAMP | Timestamp of Q&A creation             |
| account_id    | UUID      | Foreign key to `account` (created by) |
| video_id      | UUID      | Foreign key to `videos`               |
| question_text | TEXT      | Account's question                    |
| answer_text   | TEXT      | Model's answer                        |

## embedding

Stores vector embeddings related to videos, used for similarity search in RAG tasks.

| Column Name | Type        | Description                     |
| ----------- | ----------- | ------------------------------- |
| id          | UUID        | Primary key                     |
| created_at  | TIMESTAMP   | Timestamp of embedding creation |
| video_id    | UUID        | Foreign key to `videos`         |
| embedding   | vector(768) | Embedding vector                |

# Unit Testing

To run unit tests for the api:

```
cd yt_assistant_api
PYTHONPATH=. pytest --cov
coverage report -m

```

To run unit tests for the client:

```
cd yt_assistant_client
npm run test
npm run coverage # run tests with coverage
```

# Scripts

Utility scripts are in `scripts/` dir.

- `init.sh`
- `alembic_migrate.sh`
